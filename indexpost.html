<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>羊了个羊闯第二关</title>
	<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<link href="//unpkg.com/layui@2.7.6/dist/css/layui.css" rel="stylesheet">
	<script src="//unpkg.com/layui@2.7.6/dist/layui.js"></script>
	<style type="text/css">

h2 {margin: 2rem;}
.layui-form {margin-right: 3rem;margin-left: -3rem;}
.layui-input-block{margin-top: 1rem;}
</style>

</head>
<body>

	<h2 align="center">羊了个羊闯第二关</h2>
	<div class="layui-form">

		  <div class="layui-form-item">
  	
	      	<label class="layui-form-label">uid</label>

	      	<div class="layui-input-block">
						<input class="layui-input" required  lay-verify="required" type="text" id="uid" ></input>
					
					</div>
			</div>

		<div class="layui-form-item" align="center">
    <div class="layui-input-block">
      <button class="layui-btn layui-btn-sm" id="tokenbtn">获取token</button>
    </div>
  </div>



  <div class="layui-form-item">
  	

	      	<label class="layui-input-block">token（获取方法公众号回复：抓包）</label>
	      <div class="layui-input-block">
	      	
					<textarea id="token" placeholder="请输入token" required  lay-verify="required" class="layui-textarea" rows="3"></textarea>
				</div>

	</div>
  <div class="layui-form-item">
					<label class="layui-input-block">次数:</label>
			<div class="layui-input-block">
					<input class="layui-input" required  lay-verify="required" type="text" id="num" value="1"></input>
			</div>

  </div>


   <div class="layui-form-item" align="center">
    <div class="layui-input-block">
      <button class="layui-btn layui-btn-lg" id="btn">闯 关</button>
    </div>
  </div>

   <div class="layui-form-item" align="center">
    <div class="layui-input-block">
      <h6 id="result"></h6>
    </div>
  </div>
</div>

<div align="center"><img src="qrcode.jpg" width="80px"><br>本项目只用于测试和学习研究<br>更多内容扫码关注公众号</div>		
</body>

<script type="text/javascript">
	let uid = document.querySelector("#uid");
	let tokenbtn = document.querySelector("#tokenbtn");
    tokenbtn.addEventListener("click",function (params) {
    	console.log("点击了tokenbtn");
    	var url = "https://cat-match.easygame2021.com/sheep/v1/user/login_oppo";
            var dataobj = {"uid": uid,"nick_name": "baidu","avatar": "https://www.baidu.com/favicon.ico","sex": 1};
            var headersobj = {"Content-Type": "application/json",
    "Host": "cat-match.easygame2021.com",
    "Referer": "https://servicewechat.com/wx141bfb9b73c970a9/14/page-frame.html",
    "User-Agent": "Mozilla/5.0 (iPhone; CPU iPhone OS 15_4_1 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Mobile/15E148 MicroMessenger/8.0.27(0x18001b36) NetType/WIFI Language/zh_HK",};
            axios.post(url,{params:dataobj},{headers:headersobj}).then(function (res) {
                console.log(res.data);
            });

    }); 

	let btn = document.querySelector("#btn");
    btn.addEventListener("click",function (params) {
		let token = document.querySelector("#token").value;
		let num = document.querySelector("#num").value;

		if(token == "")
		{
			
			layer.open({
			  title: '提示'
			  ,content: '请输入token'
			}); 
			return;
		}
		if(num == "")
		{
			
			layer.open({
			  title: '提示'
			  ,content: '请输入闯关次数'
			}); 
			return;
		}
		if (!(/(^[1-9]\d*$)/.test(num))) 
		{ 
　　　　 
				layer.open({
				  title: '提示'
				  ,content: '请输入正整数'
				});
　　　　　　return; 
　　}
		if(num > 2)
		{
			
			layer.open({
				  title: '提示'
				  ,content: '需要更多闯关次数请在公众号后台留言'
				});
　　　　　　return; 
		}
		
		let url = 'https://cat-match.easygame2021.com/sheep/v1/game/game_over?t='+token+'&rank_score=1&rank_state=1&rank_time=888&rank_role=1&skin=1';
		
		for(let index = 1;index <= num;index++){
		axios.get(url).then(function (res) {
			var data = res.data;
			console.log(data);
			if(data.err_code == 0)
			{
				var today = new Date();

       var hour = today.getHours();

       var minutes = today.getMinutes();

       var seconds = today.getSeconds();

      var timestr = hour+":"+minutes+":"+seconds;
				$("#result").text('闯关成功'+index+'次'+' '+timestr);
				}
			else
				$("#result").text('请检查token值是否正确！');
			
		});
		}
        });
</script>

</html>
