<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>test</title>
	<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
	<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
	<link href="//unpkg.com/layui@2.7.6/dist/css/layui.css" rel="stylesheet">
	<script src="//unpkg.com/layui@2.7.6/dist/layui.js"></script>
	<style type="text/css">

h2 {margin: 2rem;}
.layui-form {margin-right: 3rem;margin-left: -3rem;}
.layui-input-block{margin-top: 1rem;}
</style>

</head>
<body>

	<h2 align="center">羊了个羊闯关</h2>
	<div class="layui-form">

  <div class="layui-form-item">
  	

	      	<label class="layui-input-block">token（获取方法公众号回复：抓包）</label>
	      <div class="layui-input-block">
	      	
					<textarea id="token" placeholder="请输入token" required  lay-verify="required" class="layui-textarea" rows="6"></textarea>
				</div>

	</div>
  <div class="layui-form-item">
					<label class="layui-input-block">次数:</label>
			<div class="layui-input-block">
					<input class="layui-input" required  lay-verify="required" type="text" id="num" value="1"></input>
			</div>

  </div>


   <div class="layui-form-item" align="center">
    <div class="layui-input-block">
      <button class="layui-btn" id="btn">闯 关</button>
      <button type="reset" class="layui-btn layui-btn-primary" id="resetbt">重 置</button>
    </div>
  </div>

   <div class="layui-form-item" align="center">
    <div class="layui-input-block">
      <h6 id="result"></h6>
    </div>
  </div>
</div>

<div align="center"><img src="qrcode.jpg" width="100px"></div>		
</body>

<script type="text/javascript">

	let resetbt = document.querySelector("#resetbt");
    resetbt.addEventListener("click",function (params) {
    	$("#token").text('');
    	$("#num").text('1');

    	});

	let btn = document.querySelector("#btn");
    btn.addEventListener("click",function (params) {
		let token = document.querySelector("#token").value;
		let num = document.querySelector("#num").value;

		if(token == "")
		{
			alert("请输入token");
			return;
		}
		if(num == "")
		{
			alert("请输入闯关次数");
			return;
		}
		if (!(/(^[1-9]\d*$)/.test(num))) 
		{ 
　　　　　　alert("输入的不是正整数"); 
　　　　　　return; 
　　}
		if(num > 2)
		{
			alert("需要更多的闯关次数请后台留言"); 
　　　　　　return; 
		}
		
		let url = 'https://cat-match.easygame2021.com/sheep/v1/game/game_over?t='+token+'&rank_score=1&rank_state=1&rank_time=888&rank_role=1&skin=1';
		
		for(let index = 1;index <= num;index++){
		axios.get(url).then(function (res) {
			var data = res.data;
			console.log(data);
			if(data.err_code == 0)
				$("#result").text('闯关成功'+index+'次');
			else
				$("#result").text('请检查token值是否正确！');
			
		});
		}
        });
</script>

</html>
